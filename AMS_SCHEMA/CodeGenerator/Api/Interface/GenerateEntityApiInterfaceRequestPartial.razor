@using AMS.Model.Models
@using AMS_SCHEMA.Class

@using Olive
@using System.Web
@using AMS.Model
@using AMS.Model.Services
@using AMS_SCHEMA.Pages.Schema.Label.Module
@implements IHaveDestinationFilePath
using Microsoft.AspNetCore.Mvc;
using @(Module.Name).@(Label.Name.ToPascalCase());

namespace @(Module.Name).@(Label.Name.ToPascalCase());

public partial class @(Handler.Name)Request
{

    public partial class Response
    {

    }
}

@code {
    [Parameter]
    public AmsNeo4JMicroserviceModule Module { get; set; }

    [Parameter]
    public AmsNeo4JNodeLabel Label { get; set; }

    [Parameter]
    public List<AmsNeo4JNodeRelation> Relations { get; set; }

    [Parameter]
    public HandlerSettingItem Handler { get; set; }

    // [Parameter]
    // public List<AmsNeo4JNodeConstraint> Constraints { get; set; }

    string GetParentClass()
    {
        if (Label.ParentLabel is {})
        {
            return Label.ParentLabel.Name.ToPascalCase();
        }

        return $"AbstractEntity<{Label.Name.ToPascalCase()}, Guid>";
    }

    string IsNullable(AmsNeo4JNodeLabelProperty fld)
    {
        return fld.Label.Constraints.Any(x => x.Over == fld.Name && (x.Type == "IS NODE KEY" || x.Type == "IS NOT NULL")) 
            ? "" 
            : "?";
    }

    [Parameter]
    public string DestFilePath { get; set; }
}
